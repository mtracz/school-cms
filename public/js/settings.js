function postSettingsData(e){return new Promise(function(t,n){$.ajax(e).done(t).fail(n)})}function createErrorMessage(e){for(var t="",n=0;n<e.length;n++)t=t.concat(e[n])+"<br>";return t}function clearChangePasswordInputs(){$("input[type='password']").val("")}function postChangePassword(e){return new Promise(function(t,n){$.ajax(e).done(t).fail(n)})}var settingsUrl=window.location.origin+"/settings/set";$(".ui.button.settings.submit").on("click",function(e){e.preventDefault();var t=$("#settings_form :not(.change_password_toggle input):not(.field.maintenance input)").serialize();$(".field.maintenance .ui.toggle.checkbox input").is(":checked")?t+="&is_maintenance_mode=1":t+="&is_maintenance_mode=0",postSettingsData({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:settingsUrl,method:"POST",data:t,beforeSend:function(){$(".ui.dimmer").dimmer("show")}}).then(function(e){$(".ui.dimmer").dimmer("hide"),toastr.success("<h1> Zapisano zmiany! </h1>"),"error"==e.status&&toastr.error("<h2>"+e.message+"</h2>"),console.log("SettingsForm: Submit success")}).catch(function(e){console.log("SettingsForm: Submit fail. ERROR: "+e),alert("SettingsForm: Submit fail. ERROR: "+e)})}),$(".show_change_password_toggle").on("click",function(){$(".change_password_toggle").slideToggle(),$(".show_change_password_toggle").toggleClass("active")});var changePasswordUrl=window.location.origin+"/password/change";$(".ui.button.password.submit").on("click",function(e){e.preventDefault();var t=$(".change_password_toggle input").serialize();console.log(t),postChangePassword({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:changePasswordUrl,method:"POST",data:t,beforeSend:function(){$(".ui.dimmer").dimmer("show")}}).then(function(e){if($(".ui.dimmer").dimmer("hide"),console.log("data",e),"success"==e.password_change)clearChangePasswordInputs(),console.log("SettingsForm: Submit success"),toastr.success("<h2> Hasło zostało pomyślnie zmienione! </h2>");else{clearChangePasswordInputs();var t=createErrorMessage(e.errors);toastr.error(t,"<h2> Dane zmiany hasła niepoprawne </h2>"),console.log("SettingsForm: Submit fail. ERROR: Data incorrect",e.errors[0])}}).catch(function(e){console.log("SettingsForm: Submit fail. ERROR: "+e),alert("SettingsForm: Submit fail. ERROR: "+e)})});