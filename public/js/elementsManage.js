function renderOrderArrows(){var t=$("#sector_table tbody").find("tr");$.each(t,function(t,e){$(e).find(".ui.up.button").removeClass("disabled"),$(e).find(".ui.down.button").removeClass("disabled"),$(e).is(":first-child")?$(e).find(".ui.up.button").addClass("disabled"):$(e).find(".ui.up.button").removeClass("disabled"),$(e).is(":last-child")?$(e).find(".ui.down.button").addClass("disabled"):$(e).find(".ui.down.button").removeClass("disabled")})}function redirectTo(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a="?";null!==e&&(a=a.concat("sector_id="+String(e.id)+"&sector_name="+String(e.name)+"&panel_type_id="+String(e.panel_type_id)+"&item_name="+String(e.item_name))),window.location.href=t.concat(a)}function disableSectorFromSelection(t){$("#selectSectorModal.ui.modal .ui.list_selector.button").each(function(e,a){if(console.log($(this)),t){var d=$(this).attr("data-sector_panel_allowed_ids");console.log("allowedPanelsIds: ",d),-1==d.search(t)?$(this).addClass("disabled").hide():$(this).removeClass("disabled").show()}else{var o=$(this).attr("data-sector_is_menu_allowed");console.log("isMenuAllowed: ",o),0==o?$(this).addClass("disabled").hide():$(this).removeClass("disabled").show()}})}function disableElementFromSelection(t,e){$("#selectElementModal.ui.modal .ui.list_selector.button").each(function(a,d){var o=$(this).attr("data-panel_type_id");console.log("panel_type_id",o),o?(console.log(o,e.search($(this).attr("data-panel_type_id"))),-1==e.search($(this).attr("data-panel_type_id"))?$(this).addClass("disabled").hide():$(this).removeClass("disabled").show()):0==t?$(this).addClass("disabled").hide():$(this).removeClass("disabled").show()})}function setDataOrdersAsc(t){$(t).each(function(t,e){$(e).attr("data-order",t+1)})}function ajaxDeleteRequestPromise(t){return new Promise(function(e,a){$.ajax(t).done(e).fail(a)})}$(window).ready(function(){renderOrderArrows(),$("#selectSectorModal.ui.longer.modal").modal(),$("#selectElementModal.ui.longer.modal").modal()});var databaseElementsUpdater=new DatabaseElementsUpdater;$(".ui.buttons").on("click",".ui.up.button",function(){var t=$(this).closest("tbody"),e=$(this).closest("tr");setDataOrdersAsc($(t).find("tr"));var a=parseInt($(e).attr("data-order"))-1,d=$(t).find("tr[data-order='"+a+"']"),o=$(e).attr("data-order"),s=$(d).attr("data-order");$(d).attr("data-order",o),$(e).attr("data-order",s),$(d).before($(e)),renderOrderArrows(),databaseElementsUpdater.addElement($(e).attr("data-id"),$(e).attr("data-sector_id"),$(e).attr("data-order"),$(e).attr("data-is_enabled")),databaseElementsUpdater.addElement($(d).attr("data-id"),$(d).attr("data-sector_id"),$(d).attr("data-order"),$(d).attr("data-is_enabled"))}),$(".ui.buttons").on("click",".ui.down.button",function(){var t=$(this).closest("tbody"),e=$(this).closest("tr");setDataOrdersAsc($(t).find("tr"));var a=parseInt($(e).attr("data-order"))+1,d=$(t).find("tr[data-order='"+a+"']"),o=$(d).attr("data-order"),s=$(e).attr("data-order");$(d).attr("data-order",s),$(e).attr("data-order",o),$(d).after($(e)),renderOrderArrows(),databaseElementsUpdater.addElement($(e).attr("data-id"),$(e).attr("data-sector_id"),$(e).attr("data-order"),$(e).attr("data-is_enabled")),databaseElementsUpdater.addElement($(d).attr("data-id"),$(d).attr("data-sector_id"),$(d).attr("data-order"),$(d).attr("data-is_enabled"))}),$(".actions").on("click",".ui.edit.button",function(){redirectTo($(this).attr("data-url"),{id:$(this).closest("tr").attr("data-sector_id"),name:$(this).closest("tr").attr("data-sector_name")})}),$(".actions").on("click",".ui.delete.button",function(){var t=$(this);$(".ui.basic.delete_aggrement.modal").modal({closable:!1,onDeny:function(){},onApprove:function(){ajaxDeleteRequestPromise({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"post",url:$(t).attr("data-url").replace(window.location.origin,""),data:parseInt($(t).attr("data-id"))}).then(function(e){if("success"===e){var a=$(t).closest("tbody");$(t).closest("tr").remove();var d=$(a).find("tr");renderOrderArrows(),setDataOrdersAsc(d),console.log("ajaxDeleteRequestPromise: success"),toastr.success("Usunięto")}else toastr.error("Problem z usunięciem")}).catch(function(){console.log("ajaxDeleteRequestPromise: fail"),toastr.error("Problem z usunięciem")})}}).modal("show")}),$(".actions").on("click",".ui.toggle.show.button",function(){console.log($(this)),$(this).removeClass().addClass("ui toggle hide button").attr("data-tooltip","Ukryj element"),$(this).find("i").removeClass("unhide").addClass("hide");var t=$(this).closest("tr");$(t).attr("data-is_enabled",1),$(t).removeClass("disable"),databaseElementsUpdater.addElement($(t).data("id"),$(t).data("sector_id"),$(t).data("order"),$(t).data("is_enabled"))}),$(".actions").on("click",".ui.toggle.hide.button",function(){console.log($(this)),$(this).removeClass().addClass("ui toggle show button").attr("data-tooltip","Pokaż element"),$(this).find("i").removeClass("hide").addClass("unhide");var t=$(this).closest("tr");$(t).attr("data-is_enabled",0),$(t).addClass("disable"),databaseElementsUpdater.addElement($(t).attr("data-id"),$(t).attr("data-sector_id"),$(t).attr("data-order"),$(t).attr("data-is_enabled"))}),$(".actions").on("click",".ui.move.button",function(){$("#selectSectorModal .selected_item_name").text($(this).closest("tr").find("td.name").text());var t=$(this).closest("tr"),e=$(t).attr("data-id"),a=$(this).closest("tr").attr("data-panel_type_id");$("#selectSectorModal.ui.longer.modal").modal({onShow:function(){console.log("selectSectorModal"),disableSectorFromSelection(a)},onHide:function(){$(".scrolling.content").find(".ui.button").removeClass("activated"),$(".ui.green.ok.inverted.button").addClass("disabled")},onApprove:function(a){var d=$(a).parent().parent().find(".ui.list_selector.activated");$(d).removeClass("activated");var o=$(d).attr("data-sector_id"),s=$(t).closest("tbody"),r=$("[data-div_sector_id='"+o+"'").find("tbody");$(t).attr("data-sector_id",o),$(t).appendTo($(r)),renderOrderArrows(),setDataOrdersAsc($(s).find("tr")),setDataOrdersAsc($(r).find("tr")),databaseElementsUpdater.addElement(e,o,$(t).attr("data-order"),$(t).attr("data-is_enabled"))}}).modal("show")}),$(".sector_header").on("click",".ui.add_element.button",function(){$("#selectElementModal .selected_item_name").text($(this).parent().find(".sector_name").text());var t=$(this).closest(".sector_data").attr("data-sector_id"),e=$(this).closest(".sector_data").find(".sector_name").text(),a=$(this).closest(".sector_data").attr("data-sector_panel_allowed_ids"),d=$(this).closest(".sector_data").attr("data-sector_is_menu_allowed");a=a.replace("3;",""),$("#selectElementModal.ui.longer.modal").modal({onShow:function(){disableElementFromSelection(d,a)},onHide:function(){$(".scrolling.content").find(".ui.button").removeClass("activated"),$(".ui.green.ok.inverted.add_move.button").addClass("disabled")},onApprove:function(a){var d=$(a).parent().parent().find(".ui.list_selector.activated");$(d).removeClass("activated");var o={id:t,name:e,panel_type_id:"",item_name:""},s=$(d).attr("data-item_name"),r=$(d).attr("data-panel_type_id");void 0!=s&&$("#selectElementModal.ui.longer.modal .ui.green.ok.inverted.button").toggleClass("disabled"),"menu"==s?redirectTo("/elements/"+s+"/add",o):(o.panel_type_id=r,o.item_name=s,redirectTo("/elements/panel/add",o))}}).modal("show")}),$(".ui.longer.modal .content").on("click",".ui.list_selector.button",function(){$(this).closest(".content").find(".ui.button").removeClass("activated"),$(this).addClass("activated"),$(".scrolling.content").find(".ui.list_selector.activated").length>0?$(".ui.green.ok.inverted.add_move.button").removeClass("disabled"):$(".ui.green.ok.inverted.add_move.button").addClass("disabled")}),$(".ui.button.save").on("click",function(){databaseElementsUpdater.sendToUpdate()}),$(".ui.button.deny.main_page").on("click",function(){window.location.href="/"});