function validateFile(e){if(inputAlert(""),$("#file").val()<1)return $("#file_name").html(""),disableAddFileButton(),!1;var t=e.files[0],n=t.name;if(max_file_size=20971520,$("#file").val()<1)return $("#file_name").html(""),enableAddFileButton(),!1;if(t.size>max_file_size){var i="Za duży plik, max 20 Mb.";return inputAlert(i),!1}if(n.length>0){for(var a=!1,l=0;l<_validFileExtensions.length;l++){var o=_validFileExtensions[l];if(n.substr(n.length-o.length,o.length).toLowerCase()===o.toLowerCase()){a=!0;break}}if(!a){var i="Zły plik, dozwolone: "+_validFileExtensions.join(", ");return inputAlert(i),!1}n.length>40&&(n=n.substring(0,39)+"..."),$("#file_name").html(n),enableAddFileButton()}}function enableAddFileButton(){$("#add_file_button").hasClass("disabled")&&$("#add_file_button").removeClass("disabled")}function disableAddFileButton(){$("#add_file_button").hasClass("disabled")||$("#add_file_button").addClass("disabled")}function sendEventPromise(e){return new Promise(function(t,n){$.ajax(e).done(t).fail(n)})}function sendFileViaAjax(){sendEventPromise({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:$("#upload_file_form").attr("action"),type:"POST",data:new FormData($("#upload_file_form")[0]),contentType:!1,processData:!1}).then(function(e){"success"===e.file_status?(document.getElementById("upload_file_form").reset(),$("#file_name").html(""),disableAddFileButton(),toastr.success("Dodano plik"),getFilesViaAjax()):($data=JSON.parse(e),$.each($data,function(e,t){$(".input.alert").append("<p><i class='warning icon'></i>"+t+"</p>")}))}).catch(function(e){alert("file add ajax error: "+e)})}function inputAlert(e){$(".alert")[0].removeAttribute("hidden"),$(".input.alert").html(e)}function getFiles(e){return new Promise(function(t,n){$.ajax(e).done(t).fail(n)})}function getFilesViaAjax(){getFiles({url:$("#files_dropdown").data("file_route"),type:"get"}).then(function(e){$data=JSON.parse(e),$.each($data,function(e,t){checkIsValueInDropdown(e)||$("#files_dropdown").append("<option value="+e+">"+t+"</option>")})}).catch(function(e){alert("file add ajax error: "+e)})}function checkIsValueInDropdown(e){var t,n=document.getElementById("files_dropdown"),i=!1;for(t=0;t<n.length;t++)n.options[t].value===e&&(i=!0);return i}var _validFileExtensions=[".pdf",".doc",".docx"],input=document.getElementById("file");input.addEventListener("change",function(){validateFile(this)}),$(".ui.menuAdmin_add_file").on("click",function(){getFilesViaAjax()}),$("#input_button").on("click",function(){return $("#file").click(),!1}),$("#add_file_button").on("click",function(e){return $(".input.alert").html(""),e.preventDefault(),e.stopImmediatePropagation(),sendFileViaAjax(),!1}),$("#copy_to_clipboard").on("click",function(){var e=$("#files_dropdown").find(":selected").val();e&&copyToClipboard(e)});