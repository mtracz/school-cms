function runContentTools(){var e;e=ContentTools.EditorApp.get(),e.init("*[data-editable]","data-name"),ContentTools.IMAGE_UPLOADER=imageUploader,ContentEdit.TRIM_WHITESPACE=!1,ContentTools.StylePalette.add([new ContentTools.Style("Wyrównaj do lewej","align-left",["img","iframe"]),new ContentTools.Style("Wyrównaj do prawej","align-right",["img","iframe"]),new ContentTools.Style("Wyrównaj do lewej w lini","align-left-inline",["img","iframe"]),new ContentTools.Style("Wyrównaj do prawej w lini","align-right-inline",["img","iframe"]),new ContentTools.Style("Wyśrodkuj","align-center",["img","iframe"]),new ContentTools.Style("Wyśrodkuj w lini","align-center-inline",["img","iframe"]),new ContentTools.Style("Wyjustuj tekst","text-justify",["p"]),new ContentTools.Style("Zaokrąglone rogi","border-radius",["img","iframe"]),new ContentTools.Style("Nie umieszczaj zdjęcia po lewej","image-off-left",["p","a"]),new ContentTools.Style("Nie umieszczaj zdjęcia po prawej","image-off-right",["p","a"]),new ContentTools.Style("Nie umieszczaj zdjęcia po bokach","image-off-both",["p","a"]),new ContentTools.Style("Tabela UI","ui",["table"]),new ContentTools.Style("Tabela (obramowanie w środku)","celled",["table"]),new ContentTools.Style("Tabela (wymagane)","table",["table"]),new ContentTools.Style("Link","link",["img"]),new ContentTools.Style("Mały margines góra","padding-small-up",["p","a","table","iframe","img"]),new ContentTools.Style("Mały margines dół","padding-small-down",["p","a","table","iframe","img"]),new ContentTools.Style("Mały margines lewo","padding-small-left",["p","a","table","iframe","img"]),new ContentTools.Style("Mały margines prawo","padding-small-right",["p","a","table","iframe","img"]),new ContentTools.Style("Duży margines góra","padding-big-up",["p","a","table","iframe","img"]),new ContentTools.Style("Duży margines dół","padding-big-down",["p","a","table","iframe","img"])]),ContentEdit.Root.get().bind("focus",function(t){e.toolbox().tools(DEFAULT_TOOLS)}),e.addEventListener("saved",function(t){var n,a,o;if(o=t.detail().regions,0!=Object.keys(o).length){this.busy(!0),a=new FormData;for(n in o)o.hasOwnProperty(n)&&(a.append(n,o[n]),"content"==n&&(form_content=o[n],new ContentTools.FlashUI("ok"),e.busy(!1)))}})}function imageUploader(e){function t(t){var l;o=function(t){var l;4==t.target.readyState&&(a=null,o=null,e.busy(!1),200==parseInt(t.target.status)?(l=JSON.parse(t.target.responseText),n={size:l.size,url:l.url+"?_ignore="+Date.now()},e.populate(n.url,n.size)):new ContentTools.FlashUI("no"))},e.busy(!0),l=new FormData,l.append("url",n.url),l.append("direction",t);var r=$('meta[name="csrf-token"]').attr("content");a=new XMLHttpRequest,a.addEventListener("readystatechange",o),a.open("POST","/content_tools/rotate_image",!0),a.setRequestHeader("X-CSRF-TOKEN",r),a.send(l)}var n,a,o,l;e.addEventListener("imageuploader.cancelupload",function(){a&&(a.upload.removeEventListener("progress",l),a.removeEventListener("readystatechange",o),a.abort()),e.state("empty")}),e.addEventListener("imageuploader.clear",function(){e.clear(),n=null}),e.addEventListener("imageuploader.fileready",function(t){var r,i=t.detail().file;l=function(t){e.progress(t.loaded/t.total*100)},o=function(t){var r;4==t.target.readyState&&(a=null,l=null,o=null,200==parseInt(t.target.status)?(r=JSON.parse(t.target.responseText),n={size:r.size,url:r.url},e.populate(n.url,n.size)):new ContentTools.FlashUI("no"))},e.state("uploading"),e.progress(0),r=new FormData,r.append("image",i);var s=$('meta[name="csrf-token"]').attr("content");a=new XMLHttpRequest,a.upload.addEventListener("progress",l),a.addEventListener("readystatechange",o),a.open("POST","/content_tools/upload_image",!0),a.setRequestHeader("X-CSRF-TOKEN",s),a.send(r)}),e.addEventListener("imageuploader.rotateccw",function(){t("CCW")}),e.addEventListener("imageuploader.rotatecw",function(){t("CW")}),e.addEventListener("imageuploader.save",function(){var t;o=function(t){if(4===t.target.readyState)if(a=null,o=null,e.busy(!1),200===parseInt(t.target.status)){var n=JSON.parse(t.target.responseText);e.save(n.url+"?_ignore="+Date.now(),n.size,{alt:n.alt,"data-ce-max-width":n.size[0]})}else new ContentTools.FlashUI("no")},e.busy(!0),t=new FormData,t.append("url",n.url),e.cropRegion()&&t.append("crop",e.cropRegion());var l=$('meta[name="csrf-token"]').attr("content");a=new XMLHttpRequest,a.addEventListener("readystatechange",o),a.open("POST","/content_tools/save_image",!0),a.setRequestHeader("X-CSRF-TOKEN",l),a.send(t)})}$(document).ready(function(){runContentTools()});